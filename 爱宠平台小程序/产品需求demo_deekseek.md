# 宠物邻里 - 小程序产品设计文档 (v1.0 Demo版)

## 1. 项目概述

| 项目名称 | 宠物邻里 |
|---------|---------|
| **项目简介** | 一款服务于养宠人士的本地化生活平台，核心解决宠物丢失寻找问题，并整合寄养、配种、收养、本地信息服务，构建一个互助、可信的宠物社区。 |
| **目标用户** | 养猫/养狗人士、宠物救助者、潜在领养人、宠物服务提供者（个人或商家）。 |
| **Demo核心目标** | 验证"宠物寻回"与"本地信息发布"两大核心功能的用户流程与技术可行性。 |

## 2. 功能模块

### 2.1 首页

- **顶部搜索栏**：可搜索帖子内容、品种、地点
- **信息流展示**：
  - 默认展示所有用户发布的"寻宠"和"发现"帖子，按发布时间倒序排列
  - 帖子卡片显示：宠物图片（首张）、标题、品种、地点（大致范围）、发布时间
- **底部导航栏**：
  - **首页**：当前页面
  - **发布**：跳转到发布页面
  - **我的**：跳转到个人中心

### 2.2 发布功能页

- **发布类型选择器**（顶部Tab切换）：
  1. **寻宠**：我的宠物丢了
  2. **发现**：我看到了走失的宠物
  3. **寄养/配种**：提供或寻求服务
  4. **收养**：提供领养或申请领养
  5. **活动/服务**：发布宠物活动或推荐医院、殡葬等服务信息

- **通用发布表单**：
  - **标题**：单行输入框
  - **宠物图片**：图片上传组件，最多9张
  - **宠物品种**：下拉选择器（预置常见猫狗品种）
  - **宠物毛色**：下拉选择器（预置常见颜色）
  - **地点**：基于微信授权获取，可手动调整
  - **详细描述**：多行文本输入框
  - **联系方式**：输入框（默认读取用户资料中的手机号，可修改）

- **类型特定字段**：
  - **寻宠/发现**：增加"丢失/发现时间"字段
  - **寄养/配种**：增加"服务类型"（提供/寻求）、"价格/报酬"字段
  - **收养**：增加"领养状态"（待领养/已领养）字段
  - **活动/服务**：增加"活动时间"或"服务地址"字段

### 2.3 帖子详情页

- **顶部**：轮播图展示宠物图片
- **中部**：展示帖子所有信息（标题、品种、毛色、地点、时间、详细描述等）
- **底部操作区**：
  - **"联系Ta"按钮**：点击后显示完整的联系方式
  - **"相似提醒"按钮**（仅限"寻宠"和"发现"帖子）：点击后，系统会根据**品种、主要毛色、地理位置**为该帖子计算并列出相似的帖子

### 2.4 个人中心

- **用户头像与昵称**：显示微信授权信息
- **功能列表**：
  - **我发布的**：列表形式展示用户自己发布的所有帖子
  - **我收到的提醒**：展示系统推送的相似宠物匹配提醒
  - **关于我们**：小程序介绍

## 3. 核心交互流程

### 3.1 宠物寻回与匹配流程

1. **用户A**发布"寻宠"帖子，填写信息（品种：金毛，毛色：金色，地点：北京朝阳公园）
2. **用户B**发布"发现"帖子，填写信息（品种：金毛，毛色：浅金色，地点：北京朝阳公园附近）
3. **系统后台**定时任务（或发布时触发）进行匹配计算
   - **匹配规则（Demo版）**：
     - **品种完全匹配**
     - **主毛色相似**（例如，"金色"和"浅金色"视为相似）
     - **地理位置在N公里内**（例如，5公里）
4. 当规则满足时，系统同时向**用户A**和**用户B**的"我收到的提醒"中推送一条消息，如："您寻找的金毛与[朝阳公园附近发现的金毛]高度相似，快去看看吧！"
5. 用户点击提醒，即可跳转到对应的帖子详情页

## 4. 数据模型（简化版）

### Post（帖子表）

| 字段名 | 类型 | 说明 |
|--------|------|------|
| `_id` | ObjectId | 帖子唯一ID |
| `userId` | String | 发布者OpenID |
| `type` | String | 帖子类型：`lost`/`found`/`foster`... |
| `title` | String | 标题 |
| `images` | Array | 图片URL数组 |
| `breed` | String | 品种 |
| `color` | String | 毛色 |
| `location` | Object | `{ name: "北京朝阳公园", lat: 39.94, lng: 116.43 }` |
| `description` | String | 详细描述 |
| `contact` | String | 联系方式 |
| `createTime` | Date | 创建时间 |

### User（用户表）

| 字段名 | 类型 | 说明 |
|--------|------|------|
| `_id` | ObjectId | 用户唯一ID |
| `_openid` | String | 微信OpenID (云开发自动生成) |
| `avatarUrl` | String | 微信头像 |
| `nickName` | String | 微信昵称 |
| `phoneNumber` | String | 手机号（可选） |

### Notification（提醒表）

| 字段名 | 类型 | 说明 |
|--------|------|------|
| `_id` | ObjectId | 提醒ID |
| `userId` | String | 接收用户OpenID |
| `postId` | String | 关联的帖子ID |
| `matchedPostId` | String | 被匹配的帖子ID |
| `message` | String | 提醒内容 |
| `isRead` | Boolean | 是否已读 |
| `createTime` | Date | 创建时间 |

## 5. 技术栈建议（基于微信小程序）

- **前端**：微信小程序原生框架 (WXML, WXSS, JS)
- **后端**：微信云开发
  - **云数据库**：存储帖子、用户、提醒等数据
  - **云存储**：存储用户上传的宠物图片
  - **云函数**：用于实现复杂的后端逻辑，如**帖子匹配算法**、敏感信息过滤等

## 6. 下一步与待办

1. **UI/UX设计**：根据此文档制作低保真线框图
2. **云数据库初始化**：创建集合（表）并设计索引
3. **云函数开发**：重点开发"匹配提醒"云函数
4. **页面开发与联调**：按照功能模块分步开发
5. **测试**：重点测试发布流程、匹配逻辑和通知功能