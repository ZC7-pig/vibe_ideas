<!--test/test-user-profile.wxml-->
<view class="container">
  <view class="header">
    <text class="title">用户信息存储测试</text>
    <text class="subtitle">测试updateUserProfile云函数功能</text>
  </view>

  <view class="test-buttons">
    <button class="test-btn primary" bindtap="testUserProfile" disabled="{{testing}}">
      {{testing ? '测试中...' : '测试用户资料存储'}}
    </button>
    
    <button class="test-btn secondary" bindtap="testLoginFlow" disabled="{{testing}}">
      {{testing ? '测试中...' : '测试完整登录流程'}}
    </button>
    
    <button class="test-btn info" bindtap="testDatabaseCollections" disabled="{{testing}}">
      {{testing ? '测试中...' : '测试数据库集合'}}
    </button>
    
    <button class="test-btn warning" bindtap="testDatabasePermission" disabled="{{testing}}">
      {{testing ? '测试中...' : '测试数据库权限'}}
    </button>
    
    <button class="test-btn default" bindtap="clearResults">
      清除测试结果
    </button>
  </view>

  <view class="results-section">
    <view class="results-header">
      <text class="results-title">测试结果</text>
      <text class="results-count">共 {{testResults.length}} 条</text>
    </view>
    
    <scroll-view class="results-scroll" scroll-y>
      <view wx:if="{{testResults.length === 0}}" class="no-results">
        <text>暂无测试结果，点击上方按钮开始测试</text>
      </view>
      
      <view wx:else class="result-list">
        <view 
          class="result-item {{item.type}}" 
          wx:for="{{testResults}}" 
          wx:key="time"
        >
          <view class="result-time">{{item.time}}</view>
          <view class="result-message">{{item.message}}</view>
        </view>
      </view>
    </scroll-view>
  </view>
</view>